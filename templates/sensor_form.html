{% extends "base.html" %}

{% block title %}{{ _('Record Sensor Reading') }} - {{ _('Industrial Equipment Monitoring') }}{% endblock %}

{% block content %}
<h1 style="margin-bottom: 2rem;">{{ _('Record Sensor Reading') }}</h1>

{% if error %}
<div class="alert alert-error">
    <strong>{{ _('Error') }}:</strong> {{ error }}
</div>
{% endif %}

{% if success %}
<div class="alert alert-success">
    <strong>{{ _('Success') }}!</strong> {{ _('Sensor reading recorded successfully.') }}
    {% if alert_generated %}
    <br><strong>⚠️ {{ _('Alert generated:') }}</strong> {{ alert_message }}
    {% endif %}
    <br><a href="/">{{ _('Back to Dashboard') }}</a>
</div>
{% endif %}

<div class="card">
    <h2>{{ _('Sensor Information') }}</h2>
    <form method="POST" action="/sensors/record">
        <div class="form-group">
            <label for="equipment_id">{{ _('Equipment ID') }} *</label>
            <input 
                type="text" 
                id="equipment_id" 
                name="equipment_id" 
                required 
                placeholder="z.B. PUMPE-001"
                value="{{ request.form.equipment_id or '' }}"
                list="equipment-list"
            >
            <datalist id="equipment-list">
                {% for item in equipment %}
                <option value="{{ item.equipment_id }}">{{ item.name }}</option>
                {% endfor %}
            </datalist>
            <small style="color: #666;">{{ _('Select or enter equipment ID') }}</small>
        </div>
        
        <div class="form-group">
            <label for="sensor_type">{{ _('Sensor Type') }} *</label>
            <select id="sensor_type" name="sensor_type" required>
                <option value="">{{ _('Select sensor type...') }}</option>
                <option value="temperature" {% if request.form.sensor_type == 'temperature' %}selected{% endif %}>{{ _('Temperature') }}</option>
                <option value="pressure" {% if request.form.sensor_type == 'pressure' %}selected{% endif %}>{{ _('Pressure') }}</option>
                <option value="vibration" {% if request.form.sensor_type == 'vibration' %}selected{% endif %}>{{ _('Vibration') }}</option>
                <option value="flow_rate" {% if request.form.sensor_type == 'flow_rate' %}selected{% endif %}>{{ _('Flow Rate') }}</option>
                <option value="humidity" {% if request.form.sensor_type == 'humidity' %}selected{% endif %}>{{ _('Humidity') }}</option>
                <option value="power" {% if request.form.sensor_type == 'power' %}selected{% endif %}>{{ _('Power') }}</option>
                <option value="speed" {% if request.form.sensor_type == 'speed' %}selected{% endif %}>{{ _('Speed') }}</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="value">{{ _('Value') }} *</label>
            <input 
                type="number" 
                id="value" 
                name="value" 
                step="0.01" 
                required 
                placeholder="z.B. 75.5"
                value="{{ request.form.value or '' }}"
            >
        </div>
        
        <div class="form-group">
            <label for="unit">{{ _('Unit') }}</label>
            <input 
                type="text" 
                id="unit" 
                name="unit" 
                placeholder="z.B. °C, bar, rpm"
                value="{{ request.form.unit or '' }}"
            >
            <small style="color: #666;">{{ _('Optional: Specify unit') }}</small>
        </div>
        
        <div style="display: flex; gap: 1rem;">
            <button type="submit" class="btn btn-primary">{{ _('Record Sensor Reading') }}</button>
            <a href="/" class="btn" style="background-color: #95a5a6; color: white;">{{ _('Cancel') }}</a>
        </div>
    </form>
</div>

<!-- Quick Reference: Threshold Values -->
<div class="card">
    <h2>ℹ️ {{ _('Threshold Reference') }}</h2>
    <p>{{ _('Alarms are automatically generated when readings exceed these thresholds:') }}</p>
    <ul style="margin-left: 2rem; margin-top: 1rem;">
        <li><strong>Temperatur:</strong> > 100°C</li>
        <li><strong>Druck:</strong> > 10 bar</li>
        <li><strong>Vibration:</strong> > 5 mm/s</li>
        <li><strong>Durchflussrate:</strong> > 500 L/min</li>
    </ul>
</div>
{% endblock %}
