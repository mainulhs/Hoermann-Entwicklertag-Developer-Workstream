{% extends "base.html" %}

{% block title %}{{ equipment.name }} - {{ _('Industrial Equipment Monitoring') }}{% endblock %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
    <h1>{{ equipment.name }}</h1>
    <div style="display: flex; gap: 1rem;">
        <a href="{{ url_for('web.equipment_edit', equipment_id=equipment.equipment_id) }}" class="btn btn-primary">{{ _('Edit') }}</a>
        <form method="POST" action="{{ url_for('web.equipment_delete', equipment_id=equipment.equipment_id) }}" style="display: inline;" onsubmit="return confirm('Möchten Sie dieses Equipment wirklich löschen?');">
            <button type="submit" class="btn" style="background-color: #e74c3c; color: white;">{{ _('Delete') }}</button>
        </form>
        <a href="/" class="btn" style="background-color: #95a5a6; color: white;">← {{ _('Back to Dashboard') }}</a>
    </div>
</div>

<!-- Equipment Details -->
<div class="card">
    <h2>{{ _('Equipment Details') }}</h2>
    <table>
        <tr>
            <th style="width: 200px;">{{ _('Equipment ID') }}</th>
            <td><strong>{{ equipment.equipment_id }}</strong></td>
        </tr>
        <tr>
            <th>{{ _('Name') }}</th>
            <td>{{ equipment.name }}</td>
        </tr>
        <tr>
            <th>{{ _('Type') }}</th>
            <td>{{ equipment.type }}</td>
        </tr>
        <tr>
            <th>{{ _('Location') }}</th>
            <td>{{ equipment.location }}</td>
        </tr>
        <tr>
            <th>{{ _('Status') }}</th>
            <td>
                <span class="badge badge-{{ equipment.status }}">
                    {{ equipment.status|upper }}
                </span>
            </td>
        </tr>
        <tr>
            <th>{{ _('Created') }}</th>
            <td>{{ equipment.created_at }}</td>
        </tr>
    </table>
</div>

<!-- Recent Sensor Readings -->
<div class="card">
    <h2>{{ _('Recent Sensor Readings') }}</h2>
    {% if sensor_readings %}
    <table>
        <thead>
            <tr>
                <th>{{ _('Sensor Type') }}</th>
                <th>{{ _('Value') }}</th>
                <th>{{ _('Unit') }}</th>
                <th>{{ _('Timestamp') }}</th>
            </tr>
        </thead>
        <tbody>
            {% for reading in sensor_readings %}
            <tr>
                <td>{{ reading.sensor_type }}</td>
                <td><strong>{{ reading.value }}</strong></td>
                <td>{{ reading.unit or '-' }}</td>
                <td>{{ reading.timestamp }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>{{ _('No readings recorded yet.') }}</p>
    {% endif %}
</div>

<!-- Alerts -->
<div class="card">
    <h2>{{ _('Alerts') }}</h2>
    {% if alerts %}
    <table>
        <thead>
            <tr>
                <th>{{ _('Type') }}</th>
                <th>{{ _('Severity') }}</th>
                <th>{{ _('Message') }}</th>
                <th>{{ _('Status') }}</th>
                <th>{{ _('Created') }}</th>
            </tr>
        </thead>
        <tbody>
            {% for alert in alerts %}
            <tr>
                <td>{{ alert.alert_type }}</td>
                <td>
                    <span class="badge badge-{{ alert.severity }}">
                        {{ alert.severity|upper }}
                    </span>
                </td>
                <td>{{ alert.message }}</td>
                <td>
                    <span class="badge {% if alert.status == 'active' %}badge-critical{% else %}badge-low{% endif %}">
                        {{ alert.status|upper }}
                    </span>
                </td>
                <td>{{ alert.created_at }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>{{ _('No alerts for this equipment.') }}</p>
    {% endif %}
</div>

<!-- Maintenance History -->
<div class="card">
    <h2>{{ _('Maintenance History') }}</h2>
    {% if maintenance_records %}
    <table>
        <thead>
            <tr>
                <th>{{ _('Type') }}</th>
                <th>{{ _('Scheduled Date') }}</th>
                <th>{{ _('Completion Date') }}</th>
                <th>{{ _('Status') }}</th>
                <th>{{ _('Description') }}</th>
            </tr>
        </thead>
        <tbody>
            {% for record in maintenance_records %}
            <tr>
                <td>{{ record.maintenance_type }}</td>
                <td>{{ record.scheduled_date }}</td>
                <td>{{ record.completion_date or '-' }}</td>
                <td>
                    <span class="badge {% if record.status == 'completed' %}badge-active{% else %}badge-medium{% endif %}">
                        {{ record.status|upper }}
                    </span>
                </td>
                <td>{{ record.description or '-' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>{{ _('No maintenance records for this equipment.') }}</p>
    {% endif %}
</div>
{% endblock %}
